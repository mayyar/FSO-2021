# Part 2. Communicating with server

> Source: [Full Stack Open 2021 Part 2](https://fullstackopen.com/en/part2)

## **a. Rendering a collection, modules**

## console.log
When something does not work, don't just guess what's wrong. Instead, log or use some other way of debugging.

Don't concatenate things 'the Java way' with a plus. Separate the things to be printed with a comma:

```javascript
console.log('props value is', props)
```

## [Protip: Visual Studio Code snippets](https://marketplace.visualstudio.com/items?itemName=xabikos.ReactSnippets)

## JavaScript Arrays

If functional programming with arrays feels foreign to you, it is worth watching at least the first three parts of the YouTube video series [Functional Programming in JavaScript](https://www.youtube.com/playlist?list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84):

* Higher-order functions (Functions are values, Composition)
  * less bugs, easier to reason about, less time, re-use more code
* Map
* Reduce basics

## [Event Handlers Revisited](https://fullstackopen.com/en/part2/rendering_a_collection_modules#event-handlers-revisited)

## Rendering Collections

```javascript
import React from 'react'

const App = (props) => {
  const { notes } = props

  return (
    <div>
      <h1>Notes</h1>
      <ul>
        <li>{notes[0].content}</li>
        <li>{notes[1].content}</li>
        <li>{notes[2].content}</li>
      </ul>
    </div>
  )
}

export default App
```

This is, of course, not practical. We can improve on this by generating React elements from the array objects using the map function.

```javascript
notes.map(note => <li>{note.content}</li>)
```

Because the code generating the li tags is JavaScript, it must be wrapped in curly braces in a JSX template just like all other JavaScript code.

We will also make the code more readable by separating the arrow function's declaration across multiple lines:

```javascript
const App = (props) => {
  const { notes } = props

  return (
    <div>
      <h1>Notes</h1>
      <ul>
        {notes.map(note => 
          <li>
            {note.content}
          </li>
        )}
      </ul>
    </div>
  )
}
```

## Key-attribute

As the linked React page in the error message suggests; the list items, i.e. the elements generated by the map method, must each have a unique key value: an attribute called key.

```javascript
<ul>
    {notes.map(note => 
        <li key={note.id}>
        {note.content}
        </li>
    )}
</ul>
```

React uses the key attributes of objects in an array to determine how to update the view generated by a component when the component is re-rendered. More about this in the [React documentation](https://reactjs.org/docs/reconciliation.html#recursing-on-children).

## [Map](https://fullstackopen.com/en/part2/rendering_a_collection_modules#map)

`map` always creates a new array

 ```javascript
 notes.map(note =>
  <li key={note.id}>{note.content}</li>
)
 ```

 ## Anti-pattern: Array Indexes as Keys

 We could have made the error message on our console disappear by using the array indexes as keys. The indexes can be retrieved by passing a second parameter to the callback function of the map method:

 ```javascript
 notes.map((note, i) => ...)
 ```

 This is; however, not recommended and can create undesired problems even if it seems to be working just fine.

Read more about this in [this article](https://robinpokorny.medium.com/index-as-a-key-is-an-anti-pattern-e0349aece318).

## Refactoring Modules

```javascript
const Note = ({ note }) => {
  return (
    <li>{note.content}</li>
  )
}

const App = ({ notes }) => {
  return (
    <div>
      <h1>Notes</h1>
      <ul>
        {notes.map(note => 
          <Note key={note.id} note={note} />
        )}
      </ul>
    </div>
  )
}
```

Note that the *key* attribute must now be defined for the Note components, and not for the *li* tags like before.

Common practice is to declare each component in their own file as an ES6-module.

We have been using modules the whole time. The first few lines of the file index.js:

```javascript
import ReactDOM from 'react-dom'
import App from './App'
```

import two modules, enabling them to be used in that file. The module *react-dom* is placed into the variable `ReactDOM`, and the module that defines the main component of the app is placed into the variable `App`

Let's move our *Note* component into its own module.

In smaller applications, components are usually placed in a directory called *components*, which is in turn placed within the *src* directory. The convention is to name the file after the component.

Now, we'll create a directory called *components* for our application and place a file named *Note.js* inside. The contents of the Note.js file are as follows:

```javascript
import React from 'react'

const Note = ({ note }) => {
  return (
    <li>{note.content}</li>
  )
}

export default Note
```

Because this is a React-component, we must import React.

The last line of the module exports the declared module, the variable *Note*.

Now the file that is using the component - *App.js* - can import the module:

```javascript
import React from 'react'
import Note from './components/Note'

const App = ({ notes }) => {
  // ...
}
```

The filename extension `.js` can be omitted.

## [When the Application Breaks](https://fullstackopen.com/en/part2/rendering_a_collection_modules#when-the-application-breaks)